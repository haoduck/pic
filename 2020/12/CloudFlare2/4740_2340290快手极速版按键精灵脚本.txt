//比上个版本稍微优化了一下
//操作的间隔，坐标都加上了随机，很OK，应该可以减少卡验证的几率
//使用方法：复制全文到 [按键精灵](http://disk.gs/A:/APP/%E6%8C%89%E9%94%AE%E7%B2%BE%E7%81%B5) 新建一个脚本，然后直接运行即可。
//如果是其他同类APP应该都是通用的，改下包名即可
//如果可以的话，我的邀请码“2fu2txb”

//适应分辨率
SetScreenScale 720, 1280
Import "ShanHai.lua"
Randomize
//变量
dim p,滑动多少次后重启,隔几秒上下滑动,循环次数,检测脚本更新,当前版本,最新版本,newurl,ver,gg,启动APP后等待几秒开始滑动,启动脚本时是否先重启APP,下滑后上滑回来,提示信息,aoao,steps,hddjs,i
//设置区域↓
循环次数 = 300 //填0为无限循环
滑动多少次后重启 = 200
检测脚本更新 = True
隔几秒上下滑动 = 9
启动APP后等待几秒开始滑动 = 5 //APP冷启动一般都需要几秒才能进入界面
启动脚本时是否先重启APP = True //True为重启，否则不重启，即已经打开APP刷视频界面可填"False"不重启
下滑后上滑回来 = True //True为重复上下滑动刷两个视频，否则为一直往下滑，一直下滑更耗流量，但应该会减少触发风控概率(卡验证)
p = "com.kuaishou.nebula"
//设置区域结束↑
update()
gogogo()

Function sjdelay(dltime)
Dim sj = Int(((500-10+1) * Rnd()) + 1)
Delay dltime+sj
End Function
Function sjswipe(x1,y1,x2,y2)
Dim sj = Int(((5-1+1) * Rnd()) + 1)
Swipe x1+sj,y1+sj,x2+sj,y2+sj
End Function
Function udswipe(ao)
Dim x1,y1,x2,y2
Select Case ao
Case 0
udswipe(1)
udswipe(2)
Case 1 //滑到下一个
x1 = 350
y1 = 950
x2 = 350
y2 = 250
Case 2 //滑到上一个
x1 = 350
y1 = 250
x2 = 350
y2 = 950
Case Else
sshowMessage ("值错误，退出脚本")
EndScript
End Select

hddjs = 0
For 隔几秒上下滑动
sjdelay 700 //700+(10~500)，约1s
hddjs = hddjs + 1
sshowMessage("滑动倒计时" & hddjs & "/"&隔几秒上下滑动)
Next
sshowMessage("上下滑动")
sjswipe x1, y1, x2, y2
End Function
Function sshowMessage(text)
ShowMessage text, 2000, 100, 300
End Function
Sub udud() //↑↓↑↓
i=0
For 滑动多少次后重启
i = i + 1
If 下滑后上滑回来 = True Then
udswipe (0)
Else
udswipe(1)
End If
If steps = 0 Then
提示信息 = "重启倒计时" & i & "/" & 滑动多少次后重启
Else
提示信息="重启倒计时" & i & "/"&滑动多少次后重启&"\n当前循环次数"&aoao&"/"&循环次数
End If
sshowMessage 提示信息
sjdelay 1000
Next
End Sub
Sub firstdelay()
For 启动APP后等待几秒开始滑动
i = i + 1
sshowMessage "自爆装置加载中···"&启动APP后等待几秒开始滑动 - i
sjdelay 1000
Next
sshowMessage "OK GOGOGO!\nOK GOGOGO!\nOK GOGOGO!\nOK GOGOGO!\nOK GOGOGO!"
sjdelay 1000
End Sub
Sub apptools(aoao) //0开1关2重启
Select Case aoao
Case 0 //启动APP
RunApp p
sshowMessage ("启动APP")
sjdelay 1000
Case 1 //关闭APP
KillApp p
sshowMessage ("关闭APP")
sjdelay 1000
Case 2 //重启APP
sshowMessage ("准备重启APP")
sjdelay 1000
apptools(1)
apptools(0)
End Select
End Sub
Sub gogogo()
If 循环次数<1 Then
steps = 0
Else
steps = 1
End If
aoao = 0
Do While aoao < 循环次数
aoao = aoao + steps
If 启动脚本时是否先重启APP = True Then
sshowMessage("准备重启APP")
apptools (2)
Else
apptools(0) //启动APP
End If
firstdelay() //启动APP等待
udud() //上下滑动
apptools(2) //重启APP
Loop
EndScript
End Sub
Function update()
当前版本 = 1.10
If 检测脚本更新 = True Then
sshowMessage "检测是否有更新···"
sjdelay 1000
最新版本 = URL.Get(" http://ksjsb.haoduck.com/version") 
newurl = URL.Get(" http://ksjsb.haoduck.com/newurl") 
gg = URL.Get(" http://ksjsb.haoduck.com/gg") 
If 当前版本 <> CDbl(最新版本) Then
update() = True
Dim 返回条件 = Dialog.MsgBox("有新版本，要查看吗\n\n"&gg,2)
TracePrint 返回条件
If 返回条件 = 2 Then
Sys.SetClipText newurl
ShanHai.OpenWeb(newurl)
End If
Else
sshowMessage "已经是最新版本了喔"
sjdelay 1000
sshowMessage "已经是最新版本了喔"
sjdelay 1000
End If
End If
End Function

